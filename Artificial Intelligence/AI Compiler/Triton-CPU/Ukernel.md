### 정의

- **Ukernel(microkernel)** 은 하나의 연산 단위(예: 작은 `matmul`, `dot`, `conv`)를 **매우 작은 단위의 고성능 함수로 구성한 연산 핵심 모듈**
- **작고 반복적인 연산 블록**(예: `4x4 matmul`)을 **매우 고성능으로 최적화한 함수**
	- 전체 연산을 이 작은 고속 블록(ukernel) 단위로 나눠서 반복 처리함

### 예시
- 예: `1024x1024` 크기의 큰 행렬 곱셈
	`C[M][N] = A[M][K] × B[K][N]`

- 이걸 한 번에 처리하면 **캐시 미스**, **연산 병목**, **레지스터 오버플로우** 발생
- 대신, **작은 블록 단위**로 잘라서 반복하면 CPU 레지스터, 캐시, SIMD 명령어를 **최대한 활용**할 수 있음
```css
큰 행렬 곱셈
┌────────────┐
│ A[M=16][K] │
│ ×          │
│ B[K][N=16] │
└────────────┘

↓ Ukernel 처리 (예: 4x4 블록)

┌────┐ ┌────┐
│4x4 │×│4x4 │ ← ukernel_4x4_f32() 호출
└────┘ └────┘

↳ 반복해서 전체 행렬을 채움
```

### Triton에서의 Ukernel

- 일반적으로 `dot`, `matmul`, `reduction` 등의 연산을 직접 LLVM IR로 만들기보다, **최적화된 외부 함수로 치환**해서 처리
- 즉, Ukernel은 "라이브러리 호출로 변환 가능한 고성능 연산 단위"

### 대표 Ukernel 백엔드

|Ukernel 종류|설명|
|---|---|
|`OneDNN`|Intel에서 제공하는 고성능 연산 라이브러리 (CPU용)|
|`XSMM`|`libxsmm` 벡터화된 행렬 연산 라이브러리|
|`None`|Ukernel을 사용하지 않고 직접 loop로 구현|

## 요약
##### **Ukernel은 "가장 최적의 크기로 쪼갠 연산 블록"이고**,
##### 실제로 **각 제조사나 라이브러리 개발자들이 그 하드웨어에 최적화된 Ukernel을 작성해서 제공**한다!!